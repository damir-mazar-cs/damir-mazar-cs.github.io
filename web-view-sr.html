<!DOCTYPE html>
<html lang="en">
  <head><script type="text/javascript" src="https://tppt.csq.io/inject_webview_option.js"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Webview session replay testing</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />
  </head>

  <body>
    <fieldset>
      <legend>Test webview detection</legend>
      <button id="detect_window_android_button" aria-label="detect_window_android" onClick="detectWindowAndroid();">Detect window.android</button>
      <button id="detect_user_agent_button" aria-label="detect_user_agent" onClick="detectUserAgent();">Detect userAgent</button>
      <button id="detect_window_top_button" aria-label="detect_window_top" onClick="detectWindowTop();">Detect windows top</button>
      <div id="testWebView"></div>
    </fieldset>
    <fieldset>
      <legend>Node mutations</legend>
      <button id="add_element_button" aria-label="add_element" onclick="addElement();">Add an element</button>
      <button id="add_multiple_elements_button" aria-label="add_multiple_elements" onclick="addMultipleElements();">Add multiple elements</button>
      <button id="empty_elements_button" aria-label="empty_elements" onclick="emptyElements();">Empty all</button>
      <ul id="elements"></ul>
    </fieldset>

    <fieldset>
      <legend>Form</legend>
      <form id="test-form" method="post">
        <span>Name</span>
        <input type="text" id="text_input" aria-label="text_input" name="name"/>
        <input id="submit_button" aria-label="submit_button" type="submit" value="Submit" />
      </form>
    </fieldset>

    <fieldset>
      <legend>Attribute mutations</legend>
      <button id="toggle_background_button" aria-label="toggle_background" onclick="toggleBackground();">Toggle class</button>
      <p>Tap on the fidget to trigger attribute changes</p>
      <img id="spinner" aria-label="spinner" src="./spinner.png" />
    </fieldset>
    <fieldset>
      <legend>Text mutation</legend>
      <p>Tap to edit text below</p>
      <div id="weather" contenteditable="true">The weather is sunny !</div>
    </fieldset>
    <fieldset>
      <legend>Inputs</legend>
      <label><input type="checkbox" />Checkbox</label>
      <select>
        <option>Blue</option>
        <option>Yellow</option>
        <option>Red</option>
      </select>
      <input type="text" />
      <input type="password" />
      <br />
      <br />
      <textarea></textarea>
      <input value="maison" />
      <input id="number_input" aria-label="number_input" type="number" />
    </fieldset>
    <fieldset>
      <legend>Inputs (check support)</legend>
      <input type="range" id="vol" aria-label="vol" name="vol" min="0" max="50" />
      <input
        type="tel"
        id="phone"
        aria-label="phone"
        name="phone"
        pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}"
      />
      <input type="time" id="appt" aria-label="appt" name="appt" />
      <input type="week" id="week" aria-label="week" name="week" />
      <input type="color" id="favcolor" aria-label="favcolor" name="favcolor" />
    </fieldset>
    <fieldset>
      <legend>Test bridge functions</legend>
      <div style="display: flex; flex-wrap: wrap; gap: 15px 25px">
        <button id="js_bridge_optin_button" aria-label="js_bridge_optin" onclick="jsBridgeOptIn()">optIn</button>
        <button id="js_bridge_optout_button" aria-label="js_bridge_optout" onclick="jsBridgeOptOut()">optOut</button>
        <button id="js_bridge_send_event_button" aria-label="js_bridge_send_event" onclick="jsBridgeSendEvent()">sendEvent</button>
        <div>
          <select id="logLevel" name="logChoice">
            <option value="debug" selected>debug</option>
            <option value="warn">warn</option>
            <option value="error">error</option>
            <option value="critical">critical</option>
          </select>
          <button id="js_bridge_send_log_button" aria-label="js_bridge_send_log" onclick="jsBridgeSendLog()">sendLog</button>
        </div>
        <button id="js_bridge_send_dynamic_var_button" aria-label="js_bridge_send_dynamic_var" onclick="jsBridgeSendDynamicVar()">sendDynamicVar</button>
        <button id="js_bridge_send_transaction_button" aria-label="js_bridge_send_transaction" onclick="jsBridgeSendTransaction()">sendTransaction</button>
        <button id="js_bridge_send_transaction_with_items_button" aria-label="js_bridge_send_transaction_with_items" onclick="jsBridgeSendTransactionWithItems()">sendTransactionWithItems</button>
        <button id="js_bridge_send_stringified_transaction_button" aria-label="js_bridge_send_stringified_transaction" onclick="jsBridgeSendStringifiedTransaction()">sendStringifiedTransaction</button>
        <button id="js_bridge_send_srevent_button" aria-label="js_bridge_send_srevent" onclick="jsBridgeSendSREvent()">sendSREvent</button>
        <button id="js_bridge_send_srassets_button" aria-label="js_bridge_send_srassets" onclick="jsBridgeSendSRAssets()">sendSRAssets</button>
        <button id="js_bridge_send_assets_button" aria-label="js_bridge_send_assets" onclick="jsBridgeSendAssets()">sendAssets</button>
        <button id="js_bridge_send_assets_with_serialization_button" aria-label="js_bridge_send_assets_with_serialization" onclick="jsBridgeSendAssets(true)">sendAssets with serializationId</button>
        <button id="js_bridge_send_assets_with_local_assets_button" aria-label="js_bridge_send_assets_with_local_assets" onclick="jsBridgeSendAssetsWithLocalAssets()">sendAssets with local assets</button>
        <button id="js_bridge_send_assets_with_local_assets_serialization_button" aria-label="js_bridge_send_assets_with_local_assets_serialization" onclick="jsBridgeSendAssetsWithLocalAssets(true)">sendAssets with local assets and serializationId</button>
      </div>
    </fieldset>
    <fieldset>
      <legend>Page navigation</legend>
      <div style="display: flex; flex-direction: column; gap: 15px 25px">
        <a
          href="https://tupeuxpastest.csq.io/session-replay/tracking-tag-webview/anonymization/home.html"
          >Anonymization Home Page</a
        >
        <a
          href="https://tupeuxpastest.csq.io/session-replay/tracking-tag-webview/anonymization/product.html"
          >Anonymization Product Page</a
        >
        <a
          href="https://tupeuxpastest.csq.io/mobile/web-view-sr-without-tag.html"
          >Page without tag</a
        >
        <a
          href="https://tupeuxpastest.csq.io/mobile/web-view-sr-with-web-tag.html"
          >Page with web tag</a
        >
      </div>
    </fieldset>
    <fieldset id="pii">
      <legend>PII handlers</legend>
      <div>Following content should be masked</div>
      <p id="id-cs-mask" data-cs-mask>emailsensible@gmail.com</p>
      <div>Following content should not be anonymized</div>
      <p id="id-cs-capture" data-cs-capture>
        some piece of text that is not sensitive
      </p>
      <div>
        <div id="sensitive-div">I'm a sensitive div</div>
        <div id="sensitive-attr-child" data-should-be-removed-child>
          Sensitive attribute section
        </div>
        <div id="capturedId">Should be visible</div>
      </div>
    </fieldset>
    <fieldset id="gesturesSpace">
      <legend>Gesture tests</legend>
    </fieldset>
    <img src="./pic.png" alt="picture" id="picture-holder" />
    <script type="text/javascript" src="./lib-wv-sr.js"></script>
    <script type="text/javascript">
      (function () {
        window._uxa = window._uxa || [];
        window._uxa.push(["setOption", "isWebView", true]);
        window._uxa.push([
          "setPIISelectors",
          {
            PIISelectors: [
              "#sensitive-div",
              "#sensitive-id",
              "#sensitive-child-id",
            ],
            Attributes: [
              { selector: "#sensitive-id", attrName: "data-should-be-removed" },
              {
                selector: "#sensitive-attr",
                attrName: "data-should-be-removed",
              },
              {
                selector: "#sensitive-attr-child",
                attrName: "data-should-be-removed-child",
              },
            ],
          },
        ]);
        var mt = document.createElement("script");
        mt.type = "text/javascript";
        mt.async = true;
        mt.src = "https://t-staging.contentsquare.net/uxa/81c677ba742d8.js";
        document.getElementsByTagName("head")[0].appendChild(mt);
      })();
    </script>
  </body>
</html>
